(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[417],{5619:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/create",function(){return n(453)}])},6964:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var o=n(5893),a=n(1163),s=n(7294),i=n(9777);let r=()=>{let[e,t]=(0,s.useState)([]),[n,o]=(0,s.useState)([]),a=(0,s.useCallback)(async()=>{let e=await i.x.boke.$get();Array.isArray(e)?(t(e),o(e.map(e=>e.image))):e?console.error("Expected an array of BokeModel but received a single instance."):console.error("Failed to fetch boke data")},[]);return{homeBokeData:e,setHomeBokeData:t,homeBokeImg:n,setHomeBokeImg:o,fetchHomeboke:a}};var c=n(1985),l=n.n(c),d=e=>{let{customStyle:t}=e,{homeBokeData:n,fetchHomeboke:i}=r(),[c,d]=(0,s.useState)([]),m=(0,a.useRouter)();(0,s.useEffect)(()=>{i()},[i]),(0,s.useEffect)(()=>{n.length>0&&d(n.slice(0,5))},[n]),(0,s.useEffect)(()=>{let e=setInterval(()=>{if(0===n.length)return;let e=[...c.slice(1)],t=n.findIndex(t=>t===e[e.length-1])+1;void 0!==n[t]?e.push(n[t]):e.push(n[0]),d(e)},5e3);return()=>clearInterval(e)},[c,n]);let h=e=>{m.push("/view/".concat(e.bokeId,"?order=createdAt"))};return(0,o.jsx)("div",{className:"".concat(l().imageContainer," ").concat(t),children:c.map(e=>(0,o.jsx)("img",{src:e.image,alt:"Boke image ".concat(e.bokeId),className:l().displayedImg,onClick:()=>h(e)},e.bokeId))})}},1191:function(e,t,n){"use strict";var o=n(5893),a=n(3024),s=n(9417),i=n(2489),r=n(1508),c=n(5295),l=n.n(c);t.Z=()=>{let e=window.location.pathname;return(0,o.jsxs)("div",{className:l().footer,children:[(0,o.jsx)("div",{className:l().footerTop,children:(0,o.jsx)("div",{className:l().textTopLeft,children:"Thinker"})}),(0,o.jsxs)("div",{className:l().column,children:[(0,o.jsx)("a",{href:"https://twitter.com/mctabetai_0905",target:"_blank",rel:"noopener noreferrer",children:(0,o.jsx)(i.G,{icon:a.mim,size:"2x",style:{color:"#fff"}})}),(0,o.jsx)("a",{href:"https://github.com/s1f102100793/thinker-ogiri",target:"_blank",rel:"noopener noreferrer",children:(0,o.jsx)(i.G,{icon:a.M0L,size:"2x",style:{color:"#fff"}})})]}),(0,o.jsx)(r.Z,{currentPath:e,styles:l()}),(0,o.jsx)("div",{className:l().rightColumn,children:(0,o.jsx)("button",{className:l().topButton,onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},children:(0,o.jsx)(i.G,{icon:s.nIL,size:"3x",style:{color:"#434343"}})})})]})}},1587:function(e,t,n){"use strict";var o=n(5893),a=n(1508),s=n(1014),i=n.n(s);t.Z=()=>{let e=window.location.pathname;return(0,o.jsxs)("div",{className:i().headerContainer,children:[(0,o.jsx)("div",{className:i().headerTop,children:(0,o.jsx)("div",{className:i().textBottomLeft,children:"Thinker"})}),(0,o.jsx)(a.Z,{currentPath:e,styles:i()})]})}},1508:function(e,t,n){"use strict";var o=n(5893);n(7294),t.Z=e=>{let{currentPath:t,styles:n}=e;return(0,o.jsxs)("div",{className:n.linklist,children:[(0,o.jsx)("a",{href:"/",className:"".concat(n.link," ").concat("/"===t?n.active:""),children:"Home"}),(0,o.jsx)("a",{href:"/view",className:"".concat(n.link," ").concat("/view/"===t?n.active:""),children:"View"}),(0,o.jsx)("a",{href:"/create",className:"".concat(n.link," ").concat("/create/"===t?n.active:""),children:"Create"}),(0,o.jsx)("a",{href:"/outstanding",className:"".concat(n.link," ").concat("/outstanding/"===t?n.active:""),children:"Outstanding"})]})}},453:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var o=n(5893),a=n(9008),s=n.n(a),i=n(7357),r=n(8456),c=n(7799),l=n(5861),d=n(3511),m=n(7294),h=n(6964),u=n(6420),_=n.n(u),g=e=>{let{imageData:t,loading:n,createImage:a,imageSize:s,bokeText:u,setBokeText:g,timeRemaining:p,setTimeRemaining:x,isDialogOpen:j,setIsDialogOpen:f,newSubmitBoke:C}=e;return(0,m.useEffect)(()=>{let e;return t&&!n&&(e=setInterval(()=>{x(e=>(1===e&&f(!0),Math.max(e-1,0)))},1e3)),()=>{clearInterval(e)}},[t,n,x,f]),(0,o.jsxs)("div",{className:_().content,children:[t?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:_().imageContainer,children:(0,o.jsx)("img",{src:"data:image/png;base64,".concat(t),alt:"Generated Data",width:s,height:s})}),(0,o.jsx)("input",{type:"text",className:_().textBox,value:u,onChange:e=>g(e.target.value),placeholder:"ぼけの言葉を入力"}),(0,o.jsxs)("div",{className:_().timerContainer,children:["残り時間: ",p,"秒"]}),(0,o.jsx)("button",{className:_().submitButton,onClick:C,children:"投稿する"})]}):(0,o.jsx)(o.Fragment,{children:n?(0,o.jsx)(i.Z,{sx:{display:"flex",position:"absolute",top:"20vh",height:"desired_height_here",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,o.jsx)(r.Z,{color:"inherit",size:80})}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:_().instructionsContainer,children:[(0,o.jsx)("p",{className:"".concat(_().instructionsText," ").concat(_().heading),children:"作り方"}),(0,o.jsxs)("p",{className:_().instructionsText,children:["1.「ぼける」ボタンをクリック！",(0,o.jsx)("br",{}),"2.画像生成",(0,o.jsx)("br",{}),"3.30秒以内にボケを考える",(0,o.jsx)("br",{}),"4.提出！"]})]}),(0,o.jsx)("button",{className:_().bokeButton,onClick:a,children:"ぼける"})]})}),(0,o.jsx)(c.Z,{className:_().modal,open:j,"aria-labelledby":"modal-title","aria-describedby":"modal-description",children:(0,o.jsxs)(i.Z,{className:_().someClass,children:[(0,o.jsx)(l.Z,{className:_().modalText,variant:"h6",component:"h2",children:"終了！"}),(0,o.jsx)(l.Z,{className:_().modalDescription,children:"あなたの時間は切れました。投稿するか、広告を見て時間を延長しますか？"}),(0,o.jsxs)("div",{className:_().buttonContainer,children:[(0,o.jsx)(d.Z,{className:_().modalButton,onClick:C,children:"投稿する"}),(0,o.jsx)(d.Z,{className:_().modalButton,onClick:()=>{x(e=>e+15),f(!1)},children:"広告を見て15秒延長"})]})]})}),(0,o.jsx)(h.Z,{customStyle:_().someCustomStyleForThisPage})]})},p=n(1191),x=n(1587),j=n(221),f=n(9777);let C=()=>{let[e,t]=(0,m.useState)(""),[n,o]=(0,m.useState)(""),[a,s]=(0,m.useState)(!1),[i,r]=(0,m.useState)(30),[c,l]=(0,m.useState)(!1),d={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0},h=async()=>{s(!0),r(30);try{var e,n;let o=await f.x.image.$post();if(!o){console.error("API response is null");return}console.log(null===(e=o.data[0])||void 0===e?void 0:e.b64_json),(null===(n=o.data[0])||void 0===n?void 0:n.b64_json)&&t(o.data[0].b64_json)}catch(e){console.error("API error:",e)}s(!1)};async function u(e){console.log("Starting compressImage function...");let t=function(e){let t=";base64,";console.log("BASE64_MARKER",t);let n=e.split(t);console.log("parts",n);let o=n[0].split(":")[1]||"image/png";console.log("Content Type:",o);let a=atob(n[1]);console.log("Raw:",a);let s=a.length,i=new Uint8Array(s);for(let e=0;e<s;++e)i[e]=a.charCodeAt(e);return new Blob([i],{type:o})}("data:image/png;base64,".concat(e));console.log("Blob:",t);let n=(t.lastModifiedDate=new Date,t.name="compressed_image.png",t),o=await (0,j.Z)(n,d);console.log("Compressed Blob:",o);let a=new FileReader;return new Promise((e,t)=>{a.onload=t=>{var n;return e(null===(n=t.target)||void 0===n?void 0:n.result)},a.onerror=e=>t(Error("Failed to read blob as DataURL")),a.readAsDataURL(o)})}let _=async()=>{console.log("Starting newSubmitBoke function...");try{console.log("Compressing image..."),console.log("Image data:",e);let a=await u(e);console.log("Image compressed successfully."),console.log("Sending compressed image data..."),await f.x.boke.post({body:{bokeId:void 0,userId:"gouta",text:n,image:a,like:0}}),console.log("Data sent successfully."),t(""),o("")}catch(e){console.error("Error in newSubmitBoke:",e)}l(!1)};return{imageData:e,setImageData:t,loading:a,timeRemaining:i,setTimeRemaining:r,isDialogOpen:c,setIsDialogOpen:l,createImage:h,imageSize:300,bokeText:n,setBokeText:o,newSubmitBoke:_}};var b=n(195),k=n.n(b),v=()=>{let{imageData:e,loading:t,timeRemaining:n,setTimeRemaining:a,isDialogOpen:i,setIsDialogOpen:r,createImage:c,imageSize:l,bokeText:d,setBokeText:m,newSubmitBoke:h}=C();return(0,o.jsxs)("div",{className:k().container,children:[(0,o.jsxs)(s(),{children:[(0,o.jsx)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,o.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"}),(0,o.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100;400&display=swap",rel:"stylesheet"})]}),(0,o.jsx)(x.Z,{}),(0,o.jsx)(g,{imageData:e,loading:t,createImage:c,imageSize:l,bokeText:d,setBokeText:m,timeRemaining:n,setTimeRemaining:a,isDialogOpen:i,setIsDialogOpen:r,newSubmitBoke:h}),(0,o.jsx)(p.Z,{})]})}},9777:function(e,t,n){"use strict";n.d(t,{x:function(){return i}});var o=n(9239),a=n(7080),s=n(6154);let i=(e=>{let{baseURL:t,fetch:n}=e,o=(void 0===t?"":t).replace(/\/$/,""),s="/boke",i="/boke/selected",r="/health",c="/image",l="/session",d="/tasks",m="/tasks/di",h="POST",u="DELETE",_="PATCH";return{boke:{selected:{get:e=>n(o,i,"GET",e).text(),$get:e=>n(o,i,"GET",e).text().then(e=>e.body),post:e=>n(o,i,h,e).json(),$post:e=>n(o,i,h,e).json().then(e=>e.body),$path:()=>"".concat(o).concat(i)},get:e=>n(o,s,"GET",e).json(),$get:e=>n(o,s,"GET",e).json().then(e=>e.body),post:e=>n(o,s,h,e).send(),$post:e=>n(o,s,h,e).send().then(e=>e.body),$path:()=>"".concat(o).concat(s)},health:{get:e=>n(o,r,"GET",e).json(),$get:e=>n(o,r,"GET",e).json().then(e=>e.body),$path:()=>"".concat(o).concat(r)},image:{get:e=>n(o,c,"GET",e).text(),$get:e=>n(o,c,"GET",e).text().then(e=>e.body),post:e=>n(o,c,h,e).json(),$post:e=>n(o,c,h,e).json().then(e=>e.body),$path:()=>"".concat(o).concat(c)},me:{get:e=>n(o,"/me","GET",e).json(),$get:e=>n(o,"/me","GET",e).json().then(e=>e.body),$path:()=>"".concat(o).concat("/me")},session:{post:e=>n(o,l,h,e).json(),$post:e=>n(o,l,h,e).json().then(e=>e.body),delete:e=>n(o,l,u,e).json(),$delete:e=>n(o,l,u,e).json().then(e=>e.body),$path:()=>"".concat(o).concat(l)},tasks:{_taskId:e=>{let t="".concat(d,"/").concat(e);return{patch:e=>n(o,t,_,e).json(),$patch:e=>n(o,t,_,e).json().then(e=>e.body),delete:e=>n(o,t,u,e).json(),$delete:e=>n(o,t,u,e).json().then(e=>e.body),$path:()=>"".concat(o).concat(t)}},di:{get:e=>n(o,m,"GET",e).json(),$get:e=>n(o,m,"GET",e).json().then(e=>e.body),$path:()=>"".concat(o).concat(m)},get:e=>n(o,d,"GET",e).json(),$get:e=>n(o,d,"GET",e).json().then(e=>e.body),post:e=>n(o,d,h,e).json(),$post:e=>n(o,d,h,e).json().then(e=>e.body),patch:e=>n(o,d,_,e).json(),$patch:e=>n(o,d,_,e).json().then(e=>e.body),delete:e=>n(o,d,u,e).json(),$delete:e=>n(o,d,u,e).json().then(e=>e.body),$path:e=>"".concat(o).concat(d).concat(e&&e.query?"?".concat((0,a._K)(e.query)):"")},get:e=>n(o,"","GET",e).text(),$get:e=>n(o,"","GET",e).text().then(e=>e.body),$path:()=>"".concat(o)}})((0,o.Z)(s.Z.create({withCredentials:!0})))},1985:function(e){e.exports={imageContainer:"BokeImageCarousel_imageContainer__wG3MY",displayedImg:"BokeImageCarousel_displayedImg__UXjRD"}},6420:function(e){e.exports={content:"CreateMainContent_content__ARdMf",instructionsContainer:"CreateMainContent_instructionsContainer__lkxTA",instructionsText:"CreateMainContent_instructionsText__K0JP1",heading:"CreateMainContent_heading__af17V",bokeButton:"CreateMainContent_bokeButton__iNPqy",someCustomStyleForThisPage:"CreateMainContent_someCustomStyleForThisPage__YCoT_",imageContainer:"CreateMainContent_imageContainer__hkTTP",textBox:"CreateMainContent_textBox__QXzeE",timerContainer:"CreateMainContent_timerContainer__jhtHI",submitButton:"CreateMainContent_submitButton__NSI9u",modal:"CreateMainContent_modal__fw3pc",someClass:"CreateMainContent_someClass__mahCE",modalText:"CreateMainContent_modalText__5i01w",modalDescription:"CreateMainContent_modalDescription__6UWVx",buttonContainer:"CreateMainContent_buttonContainer__mtbfD",modalButton:"CreateMainContent_modalButton__6lzfO"}},5295:function(e){e.exports={footer:"Footer_footer__Oesrt",footerTop:"Footer_footerTop__4bvWX",textTopLeft:"Footer_textTopLeft__2i8dZ",linklist:"Footer_linklist__DGTEC",column:"Footer_column__0I52p",rightColumn:"Footer_rightColumn__AzjlM",topButton:"Footer_topButton__g43Dn",link:"Footer_link__tl2WU",active:"Footer_active__fgXPJ"}},1014:function(e){e.exports={headerContainer:"Header_headerContainer__4fbbd",headerTop:"Header_headerTop__PiWQz",textBottomLeft:"Header_textBottomLeft__943jk",linklist:"Header_linklist__3Vzgm",link:"Header_link__p2PJz",active:"Header_active__8Eipm"}},195:function(e){e.exports={container:"create_container__X_Yqv"}}},function(e){e.O(0,[948,976,911,273,239,774,888,179],function(){return e(e.s=5619)}),_N_E=e.O()}]);